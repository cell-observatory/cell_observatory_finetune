{
	"name": "Cell Observatory Finetune",
	"build": {
		// These lines will build from Dockerfile otherwise comment these and uncomment "image" below		
		"dockerfile": "../Dockerfile",
		"context": "..",
		"options": [
			"--progress=plain"
		],
		"target": "torch_25_08"
	},
	// Uncomment this to use a pre-built image instead of building from the Dockerfile
	// "image": "ghcr.io/cell-observatory/cell_observatory_finetune:develop_torch_25_08",
	"workspaceFolder": "/workspace/cell_observatory_finetune",
	"containerUser": "ubuntu",
	"overrideCommand": true,
	"runArgs": [
		"-e",
		"PYTHONUNBUFFERED=1",
		"--entrypoint=",
		"--privileged",
		"--ipc",
		"host",
		"--ipc",
		"host",
		"--gpus",
		"all"
	],
	"mounts": [
		"source=${localWorkspaceFolder}/..,target=/workspace,type=bind,consistency=cached",
		"source=${localEnv:HOME}/.ssh,target=/home/ubuntu/.ssh,type=bind,consistency=cached",
		"source=/groups/betzig/betziglab,target=/groups/betzig/betziglab,type=bind,consistency=cached"
	],
	"customizations": {
		"vscode": {
			"settings": {
				"python.defaultInterpreterPath": "/usr/bin/python3",
				"python.terminal.activateEnvironment": true,
				"python.terminal.activateEnvInCurrentTerminal": true,
				"python.linting.enabled": true,
				"python.linting.flake8Enabled": true,
				"python.formatting.provider": "black",
				"python.formatting.blackArgs": [
					"--line-length",
					"88"
				],
				"editor.formatOnSave": true,
				"editor.codeActionsOnSave": {
					"source.organizeImports": "always"
				}
			},
			"extensions": [
				"ms-python.python",
				"eamodio.gitlens",
				"github.vscode-github-actions",
				"mechatroner.rainbow-csv"
			]
		}
	},
	"postCreateCommand": "cd /workspace/cell_observatory_finetune && export PATH=$PATH:/home/ubuntu/.local/bin && pip install bpytop  --no-dependencies && cp ~/.bashrc /tmp/host_bashrc && echo 'source /tmp/host_bashrc' >> ~/.bashrc && python3 --version",
	"postStartCommand": "cd /workspace/cell_observatory_finetune && export PATH=$PATH:/home/ubuntu/.local/bin && export PYTHONPATH=/workspace:/workspace/cell_observatory_platform:/workspace/ops3d && source ~/.bashrc"
}